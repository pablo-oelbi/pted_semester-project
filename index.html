<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Marijana Maric and Pablo Bischofberger">

<title>Commuting Mode Choice based on Distance to the next Train Station</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#background-and-research-goals" id="toc-background-and-research-goals" class="nav-link active" data-scroll-target="#background-and-research-goals">Background and Research Goals</a></li>
  <li><a href="#data-and-methods" id="toc-data-and-methods" class="nav-link" data-scroll-target="#data-and-methods">Data and Methods</a>
  <ul>
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset">Dataset</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a></li>
  <li><a href="#selection-of-relevant-trips" id="toc-selection-of-relevant-trips" class="nav-link" data-scroll-target="#selection-of-relevant-trips">Selection of Relevant Trips</a>
  <ul class="collapse">
  <li><a href="#a.-initial-state-of-the-dataset" id="toc-a.-initial-state-of-the-dataset" class="nav-link" data-scroll-target="#a.-initial-state-of-the-dataset">a. Initial State of the Dataset</a></li>
  <li><a href="#b.-performed-analysis-and-transformations-on-the-dataset" id="toc-b.-performed-analysis-and-transformations-on-the-dataset" class="nav-link" data-scroll-target="#b.-performed-analysis-and-transformations-on-the-dataset">b. Performed Analysis and Transformations on the Dataset</a></li>
  <li><a href="#c.-final-state-of-the-dataset" id="toc-c.-final-state-of-the-dataset" class="nav-link" data-scroll-target="#c.-final-state-of-the-dataset">c.&nbsp;Final State of the Dataset</a></li>
  </ul></li>
  <li><a href="#statistical-methods-and-limitations" id="toc-statistical-methods-and-limitations" class="nav-link" data-scroll-target="#statistical-methods-and-limitations">Statistical Methods and Limitations</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a>
  <ul>
  <li><a href="#statistical-analysis-to-examine-mean-value-differences" id="toc-statistical-analysis-to-examine-mean-value-differences" class="nav-link" data-scroll-target="#statistical-analysis-to-examine-mean-value-differences">Statistical Analysis to Examine Mean Value Differences</a>
  <ul class="collapse">
  <li><a href="#shapiro-wilk-and-levenes-test" id="toc-shapiro-wilk-and-levenes-test" class="nav-link" data-scroll-target="#shapiro-wilk-and-levenes-test">Shapiro-Wilk and Levene’s test</a></li>
  <li><a href="#welchs-anova-and-games-howell-post-hoc-test" id="toc-welchs-anova-and-games-howell-post-hoc-test" class="nav-link" data-scroll-target="#welchs-anova-and-games-howell-post-hoc-test">Welch’s ANOVA and Games-Howell post-hoc test</a></li>
  </ul></li>
  <li><a href="#regression-analysis" id="toc-regression-analysis" class="nav-link" data-scroll-target="#regression-analysis">Regression Analysis</a>
  <ul class="collapse">
  <li><a href="#distance" id="toc-distance" class="nav-link" data-scroll-target="#distance">Distance</a></li>
  <li><a href="#direct-distance" id="toc-direct-distance" class="nav-link" data-scroll-target="#direct-distance">Direct Distance</a></li>
  <li><a href="#time" id="toc-time" class="nav-link" data-scroll-target="#time">Time</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Commuting Mode Choice based on Distance to the next Train Station</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Marijana Maric and Pablo Bischofberger </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<!-- You can add  your R Code with Code chunks-->
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You can set chunk options individually per code chunk, as was done with this</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># code chunk.</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># echo: false           hides the code from the generated output</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># warning: false        hides warnings from the generated output</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># message: false        hides messages from the generated output</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># To apply the setting for all code chunks, add the options to the yaml header of the document (in between the ---) without the preceeding "#|".</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading all needed libraries </span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmaptools)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geosphere)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearthdata)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Write all needed functions</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get trips for a single user</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>get_trips <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(datetime) <span class="sc">%&gt;%</span>  <span class="co"># Sort data by datetime</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">time_diff =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">difftime</span>(datetime[<span class="sc">-</span><span class="dv">1</span>], datetime[<span class="sc">-</span><span class="fu">n</span>()], <span class="at">units =</span> <span class="st">"mins"</span>))) <span class="sc">%&gt;%</span>  <span class="co"># Calculate time difference between records</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">trip_id =</span> <span class="fu">cumsum</span>(transport_mode <span class="sc">!=</span> <span class="fu">lag</span>(transport_mode, <span class="at">default =</span> transport_mode[<span class="dv">1</span>]) <span class="sc">|</span> time_diff <span class="sc">&gt;</span> <span class="dv">15</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Identify individual trips</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">next_transport_mode_tmp =</span> <span class="fu">lead</span>(transport_mode, <span class="at">default =</span> <span class="cn">NA</span>),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">last_transport_mode_tmp =</span> <span class="fu">lag</span>(transport_mode, <span class="at">default =</span> <span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(trip_id) <span class="sc">%&gt;%</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">next_transport_mode =</span> <span class="fu">last</span>(next_transport_mode_tmp),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">last_transport_mode =</span> <span class="fu">first</span>(last_transport_mode_tmp)) </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>next_transport_mode_tmp <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>last_transport_mode_tmp <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate distances for one user</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>calculate_distances <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert the data to sf object for spatial operations</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  coordinates <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(data, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lon_x"</span>, <span class="st">"lat_y"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  coordinates_matrix <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(coordinates)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  distances <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">distVincentySphere</span>(coordinates_matrix[<span class="sc">-</span><span class="dv">1</span>, ], coordinates_matrix[<span class="sc">-</span><span class="fu">nrow</span>(data), ]))</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>distance <span class="ot">&lt;-</span> distances</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cumulative distance and time for each trip</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(trip_id, datetime) <span class="sc">%&gt;%</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(trip_id) <span class="sc">%&gt;%</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">cumulative_distance =</span><span class="fu">cumsum</span>(distance),</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">cumulative_time =</span> <span class="fu">cumsum</span>(time_diff),</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">elapsed_time =</span> <span class="fu">sum</span>(time_diff),</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_trip_distance =</span> <span class="fu">sum</span>(distance)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">has_train_before =</span> last_transport_mode <span class="sc">==</span> <span class="st">'Train'</span>,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">has_train_after =</span> next_transport_mode <span class="sc">==</span> <span class="st">'Train'</span>,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">has_train_somewhere =</span> transport_mode <span class="sc">==</span> <span class="st">"Train"</span> <span class="sc">|</span> next_transport_mode <span class="sc">==</span> <span class="st">'Train'</span> <span class="sc">|</span> last_transport_mode <span class="sc">==</span> <span class="st">'Train'</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to visualize a user's trajectory</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>visualize_trajectory <span class="ot">&lt;-</span> <span class="cf">function</span>(user_id, trip_id, data) {</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the specified user and trip</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  specific_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(user_id <span class="sc">==</span> <span class="sc">!!</span>user_id, trip_id <span class="sc">%in%</span> <span class="fu">c</span>((<span class="sc">!!</span>trip_id <span class="sc">-</span> <span class="dv">1</span>), <span class="sc">!!</span>trip_id, (<span class="sc">!!</span>trip_id <span class="sc">+</span> <span class="dv">1</span>)))</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If there's no data for this user and trip, return a message</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(specific_data) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"No data for this user and trip"</span>)</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert the data to a spatial object</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  data_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(specific_data, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lon_x"</span>, <span class="st">"lat_y"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the map</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tmap_mode</span>(<span class="st">"view"</span>)</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the map</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  map <span class="ot">&lt;-</span> tmap<span class="sc">::</span><span class="fu">tm_shape</span>(data_sf) <span class="sc">+</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>    tmap<span class="sc">::</span><span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"transport_mode"</span>) <span class="sc">+</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>    tmap<span class="sc">::</span><span class="fu">tm_basemap</span>(<span class="at">server =</span> <span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    tmap<span class="sc">::</span><span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"User ID:"</span>, user_id, <span class="st">"Trip ID:"</span>, trip_id))</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(map)</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>generate_ylabel <span class="ot">&lt;-</span> <span class="cf">function</span>(measure) {</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if measure is one of the expected inputs</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>(measure <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"distance"</span>, <span class="st">"total_time"</span>, <span class="st">"direct_distance"</span>))) {</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(measure)</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign a label based on the measure</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (measure <span class="sc">==</span> <span class="st">"distance"</span>) {</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>    label <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Distance (m)"</span>)</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (measure <span class="sc">==</span> <span class="st">"total_time"</span>) {</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>    label <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Time (min)"</span>)</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (measure <span class="sc">==</span> <span class="st">"direct_distance"</span>) {</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>    label <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Direct distance (m)"</span>)</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(label)</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create a boxplot</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>create_boxplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, value_column, <span class="at">remove_outliers =</span> <span class="cn">FALSE</span>, <span class="at">add_title =</span> <span class="cn">FALSE</span>, <span class="at">x_label_visible =</span> <span class="cn">TRUE</span>, <span class="at">fixed_order =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (remove_outliers) {</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(transport_mode) <span class="sc">%&gt;%</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Q1 =</span> <span class="fu">quantile</span>(<span class="fu">get</span>(value_column), <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>             <span class="at">Q3 =</span> <span class="fu">quantile</span>(<span class="fu">get</span>(value_column), <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>             <span class="at">IQR =</span> Q3 <span class="sc">-</span> Q1) <span class="sc">%&gt;%</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="co">#get(value_column) &gt;= (Q1 - 1.5 * IQR),</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>             <span class="fu">get</span>(value_column) <span class="sc">&lt;=</span> (Q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR))</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (fixed_order){</span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the fixed order for the transport_mode factor</span></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>  fixed_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Walk"</span>, <span class="st">"Bike"</span>, <span class="st">"Bus"</span>,<span class="st">"Tram"</span>, <span class="st">"Car"</span>)</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>transport_mode <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>transport_mode, <span class="at">levels =</span> fixed_order)</span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>transport_mode <span class="ot">&lt;-</span> <span class="fu">with</span>(data, <span class="fu">reorder</span>(transport_mode, <span class="fu">get</span>(value_column), <span class="at">FUN =</span> mean)) <span class="co"># Order by mean  </span></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">&lt;-</span><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> transport_mode, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">sym</span>(value_column), <span class="at">fill =</span> transport_mode)) <span class="sc">+</span></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span>  <span class="co"># Don't plot outliers</span></span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">20</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>) <span class="sc">+</span></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">generate_ylabel</span>(value_column)) <span class="sc">+</span></span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (add_title) {</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Boxplot of"</span>, value_column, <span class="st">"by Transport Mode"</span>))</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x_label_visible) {</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Transport Mode"</span>)</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>)</span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a><span class="co"># density plot</span></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>create_density_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">x_var =</span> <span class="st">"distance"</span>, <span class="at">group_var =</span> <span class="st">"transport_mode"</span>, <span class="at">title =</span> <span class="st">"Density Plot"</span>) {</span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes_string</span>(<span class="at">x =</span> x_var, <span class="at">fill =</span> group_var)) <span class="sc">+</span></span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title, <span class="at">x =</span> x_var, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>combined_boxplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, value_columns, <span class="at">remove_outliers =</span> <span class="cn">FALSE</span>, <span class="at">title =</span> <span class="st">"Combined Boxplots"</span>) {</span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create an empty list to store individual plots</span></span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>  plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>  x_label_visible <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop over value_columns to create individual boxplots</span></span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(value_columns)) {</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="fu">length</span>(value_columns)){</span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>      x_label_visible <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">create_boxplot</span>(data, value_columns[i], remove_outliers, <span class="cn">FALSE</span>, x_label_visible, <span class="cn">TRUE</span>)</span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>    plot_list[[i]] <span class="ot">&lt;-</span> p</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the plots using cowplot</span></span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>  combined_plot <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(<span class="at">plotlist =</span> plot_list, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a common title to the combined plot</span></span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>  combined_plot <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">ggdraw</span>(combined_plot) <span class="sc">+</span> </span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>    cowplot<span class="sc">::</span><span class="fu">draw_label</span>(title, <span class="at">fontface =</span> <span class="st">'bold'</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.98</span>)</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(combined_plot)</span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="background-and-research-goals" class="level2">
<h2 class="anchored" data-anchor-id="background-and-research-goals">Background and Research Goals</h2>
<p>In urban areas, understanding the factors that influence individuals’ transport mode choices is crucial for developing efficient and sustainable mobility systems <span class="citation" data-cites="europeanenvironmentagencyeea2019">(<a href="#ref-europeanenvironmentagencyeea2019" role="doc-biblioref">European Environment Agency (EEA) 2019</a>)</span>. The proximity to a train station has been identified as a significant factor in determining transport mode preferences <span class="citation" data-cites="wibowo2010">(<a href="#ref-wibowo2010" role="doc-biblioref">Wibowo and Chalermpong 2010</a>)</span>. Shorter distances to train stations may encourage walking and public transportation use, while longer distances may lead to increased reliance on private vehicles or alternative modes of transport <span class="citation" data-cites="tennoy2022">(<a href="#ref-tennoy2022" role="doc-biblioref">Tennøy, Knapskog, and Wolday 2022</a>)</span>.</p>
<p>The research goals of this study are twofold. First, we aim to investigate the impact of distance to the nearest train station on transport mode choices. By analyzing real-world data and employing statistical methods, such as ANNOVA and regression analysis, we seek to uncover patterns and relationships between distance and transport mode preferences.</p>
<p>Second, we aim to examine the role of different distance measurement methods in analyzing the relationship between distance and transport mode choice. We will explore the effectiveness of statistical methods in uncovering insights and evaluate how the choice of distance measurement influences the analysis.</p>
<p>To address these objectives and shed light on the relationship between distance to the nearest train station and transport mode choices, the following research questions will guide our investigation:</p>
<ol type="1">
<li>How does the distance to the nearest train station influence individuals’ transport mode preferences?</li>
<li>Can statistical methods, such as statistical tests and regression analysis effectively analyze the relationship between distance and transport mode choice, and provide valuable insights?</li>
<li>How does the choice of distance measurement method influence the analysis of the relationship between distance and transport mode?</li>
</ol>
</section>
<section id="data-and-methods" class="level2">
<h2 class="anchored" data-anchor-id="data-and-methods">Data and Methods</h2>
<section id="dataset" class="level3">
<h3 class="anchored" data-anchor-id="dataset">Dataset</h3>
<p>The data comprises GPS trajectory data that was collected from nine individuals between the beginning of April 2023 and the conclusion of May 2023, who were tracking their movement with the POSMO application. The Posmo Project app automatically records all activities that each individual undertakes on foot, by bike, public transport or by car <span class="citation" data-cites="genossenschaftposmoschweiz2022">(<a href="#ref-genossenschaftposmoschweiz2022" role="doc-biblioref">Genossenschaft Posmo Schweiz 2022</a>)</span>. The initial data set follows a specific structure and includes the following variables:</p>
<ul>
<li><p><strong><code>user_id</code></strong>: A unique identifier for each individual in the study. (chr)</p></li>
<li><p><strong><code>datetime</code></strong>: The date and time of each recorded location. (dttm)</p></li>
<li><p><strong><code>weekday</code></strong>: The day of the week. (chr)</p></li>
<li><p><strong><code>transport_mode</code></strong>: The mode of transportation used by the individual (e.g., walking, biking, car, bus or tram).(chr)</p></li>
<li><p><strong><code>lon_x</code></strong> and <strong><code>lat_y</code></strong>: The longitude and latitude of each recorded location.(dbl)</p></li>
</ul>
</section>
<section id="data-preparation" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation">Data Preparation</h3>
<p>The process of data cleansing, a key element in any research project, is optimized using well-defined steps. Initially, data from CSV files are compiled into a combined data frame. Subsequently, the data sets are converted into appropriate data types to ensure consistency with the following steps of the analysis. The transport mode column is modified to combine similar types like ‘Run’ and ‘Walk’. This step helps to increase the intensity of subsequent analyses. This is followed by a rigorous data cleaning process to detect and delete any instances of NA values or empty strings, ensuring data integrity and completeness. A summary of the cleand data is shown in <a href="#tbl-1">Table&nbsp;1</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List all CSV files in the directory</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>file_list <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"data"</span>, <span class="at">pattern =</span> <span class="st">"*.csv"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read each CSV file into a data frame and concatenate them together</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>posmo <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(file_list, <span class="cf">function</span>(x) <span class="fu">read.csv</span>(x, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the datetime column to POSIXct type</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>posmo<span class="sc">$</span>datetime <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(posmo<span class="sc">$</span>datetime, <span class="at">format =</span> <span class="st">"%Y-%m-%dT%H:%M:%S"</span>, <span class="at">tz =</span> <span class="st">"GMT"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert user_id to a factor and then to numeric</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>posmo<span class="sc">$</span>user_id <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(posmo<span class="sc">$</span>user_id))</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only the necessary columns and combine walk and run</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>posmo <span class="ot">&lt;-</span> posmo <span class="sc">|&gt;</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(user_id, datetime) <span class="sc">|&gt;</span>  </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(user_id, datetime,transport_mode, lon_x, lat_y) <span class="sc">|&gt;</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">transport_mode =</span> <span class="fu">ifelse</span>(transport_mode <span class="sc">==</span> <span class="st">'Run'</span>, <span class="st">'Walk'</span>, transport_mode),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">transport_mode =</span> <span class="fu">ifelse</span>(transport_mode <span class="sc">==</span> <span class="st">'Funicular'</span>, <span class="st">'Tram'</span>, transport_mode))</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for NA's and empty strings in the data</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(posmo))</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># check which columns: </span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(posmo, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">any</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co">#remove na data</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>posmo <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(posmo)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">sapply</span>(posmo <span class="sc">|&gt;</span><span class="fu">select</span>(user_id,transport_mode, lon_x, lat_y), <span class="cf">function</span>(x) <span class="fu">any</span>(x <span class="sc">==</span> <span class="st">""</span>)))</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with non-empty transport_mode</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>posmo <span class="ot">&lt;-</span> posmo<span class="sc">|&gt;</span><span class="fu">filter</span>(transport_mode <span class="sc">!=</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summarized dataframe</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>summary_df <span class="ot">&lt;-</span> posmo <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_users =</span> <span class="fu">n_distinct</span>(user_id),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_data_points =</span> <span class="fu">n</span>(),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_datetimes =</span> <span class="fu">n_distinct</span>(datetime),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_date =</span> <span class="fu">min</span>(datetime, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_date =</span> <span class="fu">max</span>(datetime, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_transport_modes =</span> <span class="fu">n_distinct</span>(transport_mode),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_longitude =</span> <span class="fu">mean</span>(lon_x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_longitude =</span> <span class="fu">max</span>(lon_x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_longitude =</span> <span class="fu">min</span>(lon_x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_latitude =</span> <span class="fu">mean</span>(lat_y, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_latitude =</span> <span class="fu">max</span>(lat_y, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_latitude =</span> <span class="fu">min</span>(lat_y, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to gt table</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># summary_table &lt;- gt(summary_df, caption = "Table 1: Summary of Posmo Data") %&gt;%</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   cols_label(</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#     num_users = "Number of Users",</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co">#     num_data_points = "Total number of datapoints",</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co">#     num_datetimes = "Number of Datetimes",</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     min_date = "Minimal recorded datetime",</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     max_date = "Maximum recorded datetime",</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     num_transport_modes = "Number of Transport Modes",</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     avg_longitude = "Average Longitude",</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     max_longitude = "Maximum Longitude",</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     min_longitude = "Minimum Longitude",</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     avg_latitude = "Average Latitude",</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     max_latitude = "Maximum Latitude",</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     min_latitude = "Minimum Latitude"</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;%</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co">#   fmt_number(</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = vars(avg_longitude, max_longitude, min_longitude, avg_latitude, max_latitude, min_latitude),</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     decimals = 2</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the table</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="co"># summary_table |&gt; as_raw_html()</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(summary_df, <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="at">num_users =</span> <span class="st">"Number of Users"</span>,</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>                                <span class="at">num_data_points =</span> <span class="st">"Total number of datapoints"</span>,</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>                                <span class="at">num_datetimes =</span> <span class="st">"Number of Datetimes"</span>,</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>                                <span class="at">min_date =</span> <span class="st">"Minimal recorded datetime"</span>,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>                                <span class="at">max_date =</span> <span class="st">"Maximum recorded datetime"</span>,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>                                <span class="at">num_transport_modes =</span> <span class="st">"Number of Transport Modes"</span>,</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>                                <span class="at">avg_longitude =</span> <span class="st">"Average Longitude"</span>,</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>                                <span class="at">max_longitude =</span> <span class="st">"Maximum Longitude"</span>,</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>                                <span class="at">min_longitude =</span> <span class="st">"Minimum Longitude"</span>,</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>                                <span class="at">avg_latitude =</span> <span class="st">"Average Latitude"</span>,</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>                                <span class="at">max_latitude =</span> <span class="st">"Maximum Latitude"</span>,</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>                                <span class="at">min_latitude =</span> <span class="st">"Minimum Latitude"</span>),</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a><span class="at">caption =</span> <span class="st">"Summary of Posmo Data {#tbl-1}"</span>, <span class="at">label =</span> <span class="st">"#tbl-1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-1" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;1: Summary of Posmo Data</caption>
<colgroup>
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Number of Users</th>
<th style="text-align: right;">Total number of datapoints</th>
<th style="text-align: right;">Number of Datetimes</th>
<th style="text-align: left;">Minimal recorded datetime</th>
<th style="text-align: left;">Maximum recorded datetime</th>
<th style="text-align: right;">Number of Transport Modes</th>
<th style="text-align: right;">Average Longitude</th>
<th style="text-align: right;">Maximum Longitude</th>
<th style="text-align: right;">Minimum Longitude</th>
<th style="text-align: right;">Average Latitude</th>
<th style="text-align: right;">Maximum Latitude</th>
<th style="text-align: right;">Minimum Latitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">116808</td>
<td style="text-align: right;">99906</td>
<td style="text-align: left;">2023-04-01 13:05:36</td>
<td style="text-align: left;">2023-05-31 14:39:59</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">8.5</td>
<td style="text-align: right;">11.5</td>
<td style="text-align: right;">-12.3</td>
<td style="text-align: right;">47.3</td>
<td style="text-align: right;">61.6</td>
<td style="text-align: right;">3.7</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Once the initial data cleaning is completed, the data cycle is further enhanced with analytical metrics. A unique identifier ‘trip_id’ is calculated for each particular trip, it provides a systematic way of classifying and analysing data. Subsequently, the data are grouped according to each trip, and then two measures of distance (in meters) and elapsed time (in minutes) are calculated for each trip. Lastly, the data set is filtered to store only trips that occur immediately before or after a train trip. This strategic selection of data lays the foundation for answering the research questions, focusing on the patterns associated with the mode of transportation before starting a train trip.</p>
<p>In the end, we have the following data structure:</p>
<ul>
<li><p><strong><code>trip_id</code></strong>: A unique identifier assigned to each individual journey made by a participant in the study. This identifier is used to differentiate between different trips made by the same user. (int)</p></li>
<li><p><strong><code>user_id</code></strong>: A unique identifier for each participant in the study. This identifier is used to differentiate between the data of different participants. (num)</p></li>
<li><p><strong><code>day</code></strong>: The date on which the recorded location data was collected. (Date)</p></li>
<li><p><strong><code>transport_mode</code></strong>: The mode of transportation used by the participant at a given recorded location. This could include various modes such as walking, using a bike, car, bus, tram, or other. (chr)</p></li>
<li><p><strong><code>last_transport_mode</code></strong>: The mode of transportation that was used by the participant directly before the current <code>transport_mode</code>. This provides a sense of sequence in the participant’s mode of transportation. (chr)</p></li>
<li><p><strong><code>next_transport_mode</code></strong>: The mode of transportation that was used by the participant directly after the current <code>transport_mode</code>. This, along with <code>last_transport_mode</code>, provides a context to the sequence of transportation modes used by the participant. (chr)</p></li>
<li><p><strong><code>distance</code></strong>: The total distance in meters covered by the participant during a particular trip. This measurement is derived from the collected location data. (num)</p></li>
<li><p><strong><code>total_time</code></strong>: The total time in minutes taken by the participant to complete a particular trip. This measurement is derived from the collected location data and corresponds to the <code>distance</code> covered in the same trip. (num)</p></li>
<li><p><strong><code>direct_distance</code></strong>: The shortest possible distance in meters between the starting and ending point of a trip. This measurement is calculated using the ‘as the crow flies’ method, which ignores any detours or turns taken during the trip. (num)</p></li>
</ul>
<p>A summary of the enhanced data is shown in <a href="#tbl-2">Table&nbsp;2</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove duplicated rows, split the data frame by user_id, apply the get_trips function to each group, and bind the results into a single data frame posmo_enriched.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>posmo_enriched <span class="ot">&lt;-</span> posmo<span class="sc">|&gt;</span><span class="fu">distinct</span>() <span class="sc">|&gt;</span> <span class="fu">group_by</span>(user_id)<span class="sc">|&gt;</span><span class="fu">group_split</span>()<span class="sc">|&gt;</span><span class="fu">map_dfr</span>(get_trips)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the calculate_distances function to each user</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>data_by_user <span class="ot">&lt;-</span> <span class="fu">split</span>(posmo_enriched, posmo_enriched<span class="sc">$</span>user_id)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>posmo_enriched <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(data_by_user, calculate_distances))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter trips that involve a train</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>posmo_enriched_train <span class="ot">&lt;-</span> posmo_enriched <span class="sc">|&gt;</span> <span class="fu">filter</span>(has_train_somewhere <span class="sc">==</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>posmo_analysis <span class="ot">&lt;-</span> posmo_enriched_train <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day =</span> lubridate<span class="sc">::</span><span class="fu">date</span>(datetime)) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trip_id, user_id, day, transport_mode, last_transport_mode, next_transport_mode) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">distance =</span> <span class="fu">sum</span>(distance),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_time =</span> <span class="fu">max</span>(cumulative_time),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">direct_distance =</span> <span class="fu">distVincentySphere</span>(<span class="fu">c</span>(lon_x[<span class="dv">1</span>], lat_y[<span class="dv">1</span>]), <span class="fu">c</span>(lon_x[<span class="fu">n</span>()], lat_y[<span class="fu">n</span>()]))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>posmo_train_related <span class="ot">&lt;-</span> posmo_analysis <span class="sc">|&gt;</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(next_transport_mode <span class="sc">==</span> <span class="st">'Train'</span> <span class="sc">|</span> last_transport_mode <span class="sc">==</span> <span class="st">'Train'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(transport_mode<span class="sc">!=</span> <span class="st">'Other1'</span> <span class="sc">&amp;</span> transport_mode<span class="sc">!=</span> <span class="st">'Train'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summarized dataframe</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>summary_df <span class="ot">&lt;-</span> posmo_analysis <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_trips =</span> <span class="fu">n_distinct</span>(trip_id),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_users =</span> <span class="fu">n_distinct</span>(user_id),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_days =</span> <span class="fu">n_distinct</span>(day),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_day =</span> <span class="fu">min</span>(day, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_day =</span> <span class="fu">max</span>(day, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_transport_modes =</span> <span class="fu">n_distinct</span>(transport_mode),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_distance =</span> <span class="fu">mean</span>(distance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_distance =</span> <span class="fu">max</span>(distance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_distance =</span> <span class="fu">min</span>(distance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_total_time =</span> <span class="fu">mean</span>(total_time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_total_time =</span> <span class="fu">max</span>(total_time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_total_time =</span> <span class="fu">min</span>(total_time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_direct_distance =</span> <span class="fu">mean</span>(direct_distance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_direct_distance =</span> <span class="fu">max</span>(direct_distance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_direct_distance =</span> <span class="fu">min</span>(direct_distance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to gt table</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co"># summary_table &lt;- gt(summary_df, caption = "Table 2: Summary of Posmo Analysis Data") %&gt;%</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   cols_label(</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     num_trips = "Number of Trips",</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     num_users = "Number of Users",</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     num_days = "Number of Days",</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     min_day = "Earliest Recorded Day",</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     max_day = "Latest Recorded Day",</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     num_transport_modes = "Number of Transport Modes",</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     avg_distance = "Average Distance (m)",</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     max_distance = "Maximum Distance (m)",</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     min_distance = "Minimum Distance (m)",</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     avg_total_time = "Average Total Time (min)",</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     max_total_time = "Maximum Total Time (min)",</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     min_total_time = "Minimum Total Time (min)",</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     avg_direct_distance = "Average Direct Distance (m)",</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co">#     max_direct_distance = "Maximum Direct Distance (m)",</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co">#     min_direct_distance = "Minimum Direct Distance (m)"</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;%</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   fmt_number(</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns = vars(avg_distance, max_distance, min_distance, avg_total_time, max_total_time, min_total_time, avg_direct_distance, max_direct_distance, min_direct_distance),</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="co">#     decimals = 2</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the table</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="co"># # print(summary_table)</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="co"># summary_table |&gt; as_raw_html()</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(summary_df, <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="at">num_trips =</span> <span class="st">"Number of Trips"</span>,</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_users =</span> <span class="st">"Number of Users"</span>,</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_days =</span> <span class="st">"Number of Days"</span>,</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_day =</span> <span class="st">"Earliest Recorded Day"</span>,</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_day =</span> <span class="st">"Latest Recorded Day"</span>,</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_transport_modes =</span> <span class="st">"Number of Transport Modes"</span>,</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_distance =</span> <span class="st">"Average Distance (m)"</span>,</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_distance =</span> <span class="st">"Maximum Distance (m)"</span>,</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_distance =</span> <span class="st">"Minimum Distance (m)"</span>,</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_total_time =</span> <span class="st">"Average Total Time (min)"</span>,</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_total_time =</span> <span class="st">"Maximum Total Time (min)"</span>,</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_total_time =</span> <span class="st">"Minimum Total Time (min)"</span>,</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_direct_distance =</span> <span class="st">"Average Direct Distance (m)"</span>,</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_direct_distance =</span> <span class="st">"Maximum Direct Distance (m)"</span>,</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_direct_distance =</span> <span class="st">"Minimum Direct Distance (m)"</span>),</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a><span class="at">caption =</span> <span class="st">"Summary of Posmo Analysis Data {#tbl-2}"</span>, <span class="at">label =</span> <span class="st">"#tbl-2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-2" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;2: Summary of Posmo Analysis Data</caption>
<colgroup>
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Number of Trips</th>
<th style="text-align: right;">Number of Users</th>
<th style="text-align: right;">Number of Days</th>
<th style="text-align: left;">Earliest Recorded Day</th>
<th style="text-align: left;">Latest Recorded Day</th>
<th style="text-align: right;">Number of Transport Modes</th>
<th style="text-align: right;">Average Distance (m)</th>
<th style="text-align: right;">Maximum Distance (m)</th>
<th style="text-align: right;">Minimum Distance (m)</th>
<th style="text-align: right;">Average Total Time (min)</th>
<th style="text-align: right;">Maximum Total Time (min)</th>
<th style="text-align: right;">Minimum Total Time (min)</th>
<th style="text-align: right;">Average Direct Distance (m)</th>
<th style="text-align: right;">Maximum Direct Distance (m)</th>
<th style="text-align: right;">Minimum Direct Distance (m)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">292</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">37</td>
<td style="text-align: left;">2023-04-03</td>
<td style="text-align: left;">2023-05-18</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">11939.3</td>
<td style="text-align: right;">1428946</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">170.8</td>
<td style="text-align: right;">9171.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">5583.9</td>
<td style="text-align: right;">63152.6</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="selection-of-relevant-trips" class="level3">
<h3 class="anchored" data-anchor-id="selection-of-relevant-trips">Selection of Relevant Trips</h3>
<p>When looking into the summary of the data, one can clearly see that, there is some work needed on outliers and identifying just relevant trips. As relevant trips, we see the usage of a transport mode to reach a train. So, a relevant trip should not be too long nor be too far. For that, we are using different box plots and other visuals to identify potential thresholds for the data.</p>
<section id="a.-initial-state-of-the-dataset" class="level4">
<h4 class="anchored" data-anchor-id="a.-initial-state-of-the-dataset">a. Initial State of the Dataset</h4>
<p>In examining the box plots, it’s evident that the outliers significantly influence the overall visual representation, making it challenging to discern underlying patterns. Furthermore, it’s noteworthy that each transportation mode exhibits distinct outlier patterns across different measures. This visualization (<a href="#fig-1">Figure&nbsp;1</a>) reinforces the necessity of further scrutinizing and refining our data, as outlined in the subsequent sections of this research project.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combined_boxplot</span>(<span class="at">data =</span> posmo_train_related, <span class="at">value_columns =</span> <span class="fu">c</span>(<span class="st">"distance"</span>, <span class="st">"direct_distance"</span>, <span class="st">"total_time"</span>), <span class="at">remove_outliers =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Boxplots of initial dataset</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="b.-performed-analysis-and-transformations-on-the-dataset" class="level4">
<h4 class="anchored" data-anchor-id="b.-performed-analysis-and-transformations-on-the-dataset">b. Performed Analysis and Transformations on the Dataset</h4>
<p>In our analysis, we focus on relevant trajectories for various modes of transportation to a train station. These modes include walking, driving, biking, bus, and tram. We filter the dataset for each mode based on specific criteria such as speed and total length. Relevant walking trips have speeds between 2-160 meters per minute and total trip time under 60 minutes. Similar criteria are applied to other modes. We combine the relevant trips for analysis and use plots to visualize time, speed, and distance, identifying outliers and patterns. This method ensures accurate analysis of each mode’s relevant trips.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add average speed</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>posmo_train_related <span class="ot">&lt;-</span> posmo_train_related <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">tripspeed =</span> distance<span class="sc">/</span>total_time) <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(tripspeed)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for walking</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>df_walk <span class="ot">&lt;-</span> posmo_train_related <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(transport_mode <span class="sc">==</span> <span class="st">"Walk"</span> <span class="sc">&amp;</span> tripspeed <span class="sc">&gt;=</span> <span class="dv">2</span> <span class="sc">&amp;</span> tripspeed <span class="sc">&lt;=</span> <span class="dv">160</span> <span class="sc">&amp;</span> total_time <span class="sc">&lt;</span> <span class="dv">60</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for car</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>df_car <span class="ot">&lt;-</span> posmo_train_related <span class="sc">%&gt;%</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(transport_mode <span class="sc">==</span> <span class="st">"Car"</span> <span class="sc">&amp;</span> tripspeed <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> total_time <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> distance <span class="sc">&lt;</span> <span class="dv">10000</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for bike</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>df_bike <span class="ot">&lt;-</span> posmo_train_related <span class="sc">%&gt;%</span> </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(transport_mode <span class="sc">==</span> <span class="st">"Bike"</span> <span class="sc">&amp;</span> tripspeed <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> total_time <span class="sc">&lt;</span> <span class="dv">120</span> <span class="sc">&amp;</span> distance <span class="sc">&lt;</span> <span class="dv">50000</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for bus</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>df_bus <span class="ot">&lt;-</span> posmo_train_related <span class="sc">%&gt;%</span> </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(transport_mode <span class="sc">==</span> <span class="st">"Bus"</span> <span class="sc">&amp;</span> tripspeed <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> total_time <span class="sc">&lt;</span> <span class="dv">120</span> <span class="sc">&amp;</span> distance <span class="sc">&lt;</span> <span class="dv">50000</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for tram</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>df_tram <span class="ot">&lt;-</span> posmo_train_related <span class="sc">%&gt;%</span> </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(transport_mode <span class="sc">==</span> <span class="st">"Tram"</span> <span class="sc">&amp;</span> tripspeed <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> total_time <span class="sc">&lt;</span> <span class="dv">60</span> <span class="sc">&amp;</span> distance <span class="sc">&lt;</span> <span class="dv">50000</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co"># combine the data frames</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>posmo_train_related_filtered <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df_walk, df_car, df_bike, df_bus, df_tram)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="c.-final-state-of-the-dataset" class="level4">
<h4 class="anchored" data-anchor-id="c.-final-state-of-the-dataset">c.&nbsp;Final State of the Dataset</h4>
<p>After all transformation, our dataset includes the most relevant trajectories for each transport mode to the train station: walking, driving, cycling, bus, and tram. Early indications from our box-plot visualizations suggest that there may be differences in mean values between transport modes (<a href="#fig-2">Figure&nbsp;2</a>, <a href="#fig-3">Figure&nbsp;3</a> and <a href="#fig-4">Figure&nbsp;4</a>). This makes us confident that our dataset can help to answer our research questions.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_boxplot</span>(<span class="at">data =</span> posmo_train_related_filtered, <span class="at">value_column =</span>  <span class="st">"distance"</span>, <span class="at">remove_outliers =</span> <span class="cn">FALSE</span>, <span class="at">add_title =</span> <span class="cn">FALSE</span>, <span class="at">fixed_order =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-2-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Boxplot of distance by transport mode</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_boxplot</span>(<span class="at">data =</span> posmo_train_related_filtered, <span class="at">value_column =</span>  <span class="st">"direct_distance"</span>, <span class="at">remove_outliers =</span> <span class="cn">FALSE</span>, <span class="at">add_title =</span> <span class="cn">FALSE</span>, <span class="at">fixed_order =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-3-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Boxplot of direct_distance by transport mode</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_boxplot</span>(<span class="at">data =</span> posmo_train_related_filtered, <span class="at">value_column =</span>  <span class="st">"total_time"</span>, <span class="at">remove_outliers =</span> <span class="cn">FALSE</span>, <span class="at">add_title =</span> <span class="cn">FALSE</span>, <span class="at">fixed_order =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-4-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4: Boxplot of total_time by transport mode</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="statistical-methods-and-limitations" class="level3">
<h3 class="anchored" data-anchor-id="statistical-methods-and-limitations">Statistical Methods and Limitations</h3>
<p>This study employed statistical analyses and regression modeling to examine the relationship between distance, time, and preferred transport modes. Three measures (distance, total time, and direct distance) were assessed across five modes of transport (Walk, Bike, Bus, Car, and Tram).</p>
<ul>
<li>Distance: This measure refers to the total length of the travel path in meters.</li>
<li>Total Time: This measure represents the total time spent for the trip, from start to end, measured in minutes.</li>
<li>Direct Distance: This measure indicates the straight-line distance from the origin to the destination, disregarding any detours or route variations.</li>
</ul>
<p>To compare differences in measures, statistical tests were chosen after checking assumptions of normality and homogeneity of variances. The Shapiro-Wilk test <span class="citation" data-cites="shapiro1965">(<a href="#ref-shapiro1965" role="doc-biblioref">Shapiro and Wilk 1965</a>)</span> was used to test for normality in each measure across the different modes of transport. To examine the homogeneity of variances Levene’s test <span class="citation" data-cites="levene1960">(<a href="#ref-levene1960" role="doc-biblioref">Levene 1960</a>)</span> was used. This test is crucial for certain statistical methods like the traditional ANOVA.</p>
<p>Since data violated assumptions, Welch’s ANOVA <span class="citation" data-cites="welch1951">(<a href="#ref-welch1951" role="doc-biblioref">Welch 1951</a>)</span> was used, followed by the Games-Howell post-hoc test <span class="citation" data-cites="games1976">(<a href="#ref-games1976" role="doc-biblioref">Games and Howell 1976</a>)</span> for pairwise comparisons.</p>
<p>Regression analysis utilized multinomial logistic regression models to estimate probabilities of choosing modes based on varying distances and total time values. Distance and time calculations were based on participants’ trajectory data, using precise coordinates and timestamps.</p>
<p>It’s important to note the small sample size limited generalizability, and biases may exist as the data only represents students in a specific module. However, these methods provided valuable insights into the relationship between distance, time, and transport mode preferences within this context.</p>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<section id="statistical-analysis-to-examine-mean-value-differences" class="level3">
<h3 class="anchored" data-anchor-id="statistical-analysis-to-examine-mean-value-differences">Statistical Analysis to Examine Mean Value Differences</h3>
<section id="shapiro-wilk-and-levenes-test" class="level4">
<h4 class="anchored" data-anchor-id="shapiro-wilk-and-levenes-test">Shapiro-Wilk and Levene’s test</h4>
<p>The results of the Shapiro-Wilk test showed significant deviation from normality (p &lt; 0.05) for all combinations of measures and transport modes. This suggests that the data for these groups do not follow a normal distribution.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro-Wilk test for normality</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>measures <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"distance"</span>, <span class="st">"total_time"</span>, <span class="st">"direct_distance"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>transport_modes <span class="ot">&lt;-</span> <span class="fu">unique</span>(posmo_train_related_filtered<span class="sc">$</span>transport_mode)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (measure <span class="cf">in</span> measures){</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (transport_mode <span class="cf">in</span> transport_modes){</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Shapiro-Wilk test for "</span>, measure, <span class="st">" and transport mode "</span>, transport_mode))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">shapiro.test</span>(posmo_train_related_filtered[[measure]][posmo_train_related_filtered<span class="sc">$</span>transport_mode<span class="sc">==</span>transport_mode]))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The results of the Levene’s test show significant deviation from the assumption of equal variances for ‘distance’ and ‘direct_distance’ (p &lt; 0.05), while ‘total_time’ did not significantly deviate from this assumption (see <a href="#tbl-3">Table&nbsp;3</a>).</p>
<div id="tbl-3" class="anchored">
<table class="table">
<caption>Table&nbsp;3: Results of Levene’s test</caption>
<thead>
<tr class="header">
<th>Measure</th>
<th>p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>distance</td>
<td>4.134e-06</td>
</tr>
<tr class="even">
<td>total_time</td>
<td>0.191</td>
</tr>
<tr class="odd">
<td>direct_distance</td>
<td>7.783e-08</td>
</tr>
</tbody>
</table>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Levene's test for homogeneity of variances</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>measures <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"distance"</span>, <span class="st">"total_time"</span>, <span class="st">"direct_distance"</span>) <span class="co"># Define the measures</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (measure <span class="cf">in</span> measures) {</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Levene's Test for"</span>, measure))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(car<span class="sc">::</span><span class="fu">leveneTest</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(measure, <span class="st">"~ transport_mode"</span>)), <span class="at">data =</span> posmo_train_related_filtered))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>} <span class="co"># Loop over all measures</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="welchs-anova-and-games-howell-post-hoc-test" class="level4">
<h4 class="anchored" data-anchor-id="welchs-anova-and-games-howell-post-hoc-test">Welch’s ANOVA and Games-Howell post-hoc test</h4>
<p>Given the violations of normality and homogeneity of variances for some of the measures, we performed Welch’s ANOVA tests, which does not require these assumptions, followed by the Games-Howell post-hoc test for pairwise comparisons.</p>
<p>The results for Welch’s ANOVA tests are as follows (<a href="#tbl-4">Table&nbsp;4</a>):</p>
<div id="tbl-4" class="anchored">
<table class="table">
<caption>Table&nbsp;4: Results for Welch’s ANOVA tests</caption>
<thead>
<tr class="header">
<th>Measure</th>
<th>F statistic</th>
<th>num df</th>
<th>denom df</th>
<th>p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Distance</td>
<td>40.118</td>
<td>4.000</td>
<td>55.619</td>
<td>8.796e-16</td>
</tr>
<tr class="even">
<td>Total Time</td>
<td>2.7365</td>
<td>4.000</td>
<td>69.250</td>
<td>0.03557</td>
</tr>
<tr class="odd">
<td>Direct Distance</td>
<td>51.228</td>
<td>4.000</td>
<td>54.141</td>
<td>&lt;2.2e-16</td>
</tr>
</tbody>
</table>
</div>
<p>The p-values for all three measures (distance, total time and direct distance) are below the threshold of 0.05. Given these results, we reject the null hypothesis of equal means across all transport modes for these measures. To further investigate the specific pairs of transport modes with significantly different means, we conducted the Games-Howell post-hoc test.</p>
<p>The results of the Games-Howell post-hoc test showed significant differences in pairwise comparisons. Below are the statistically significant results (<a href="#tbl-5">Table&nbsp;5</a>):</p>
<div id="tbl-5" class="anchored">
<table class="table">
<caption>Table&nbsp;5: Results for Games-Howell post-hoc test</caption>
<thead>
<tr class="header">
<th>Comparison</th>
<th>Estimate</th>
<th>p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bike vs Walk (distance)</td>
<td>-1795.35</td>
<td>0.019</td>
</tr>
<tr class="even">
<td>Bus vs Walk (distance)</td>
<td>-1715.39</td>
<td>4.30e-09</td>
</tr>
<tr class="odd">
<td>Car vs Walk (distance)</td>
<td>-2175.52</td>
<td>1.60e-10</td>
</tr>
<tr class="even">
<td>Tram vs Walk (distance)</td>
<td>-1480.46</td>
<td>2.34e-05</td>
</tr>
</tbody>
</table>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Welch's ANOVA for distance</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">oneway.test</span>(distance <span class="sc">~</span> transport_mode, <span class="at">data =</span> posmo_train_related_filtered, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Welch's ANOVA for total_time</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">oneway.test</span>(total_time <span class="sc">~</span> transport_mode, <span class="at">data =</span> posmo_train_related_filtered, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Welch's ANOVA for direct_distance</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">oneway.test</span>(direct_distance <span class="sc">~</span> transport_mode, <span class="at">data =</span> posmo_train_related_filtered, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Games-Howell post-hoc test for distance</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">games_howell_test</span>(posmo_train_related_filtered, distance <span class="sc">~</span> transport_mode)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Games-Howell post-hoc test for total_time</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="fu">games_howell_test</span>(posmo_train_related_filtered, total_time <span class="sc">~</span> transport_mode)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Games-Howell post-hoc test for direct_distance</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="fu">games_howell_test</span>(posmo_train_related_filtered, direct_distance <span class="sc">~</span> transport_mode)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>These results indicate that for the measure distance, Bike, Bus, Car, and Tram all had significantly higher average distance than Walk. The negative estimate values represent the average difference in distance compared to Walk, with all modes of transport having more distance on average. This pattern is similarly observed when assessing the direct distance. However, when it comes to time, the data aligns with the chart’s depiction, demonstrating that the mean times across the different modes of transport do not show significant differences.</p>
</section>
</section>
<section id="regression-analysis" class="level3">
<h3 class="anchored" data-anchor-id="regression-analysis">Regression Analysis</h3>
<section id="distance" class="level4">
<h4 class="anchored" data-anchor-id="distance">Distance</h4>
<p>The analysis conducted using multinomial logistic regression revealed interesting insights into the relationship between distance and individuals’ preferred transport modes (<a href="#tbl-6">Table&nbsp;6</a> and <a href="#fig-5">Figure&nbsp;5</a>). The probabilities of choosing different modes (Walk, Bike, Bus, Car, and Tram) were examined based on varying distances. The calculated Z-scores are fairly large, suggesting that the coefficients for each transport mode are significantly different from zero. This indicates that distance does have a significant effect on the choice of transport mode. The fit of the model seems to be reasonably good, based on the residual deviance and the AIC values.</p>
<p>The probability of choosing Walk decreased significantly as the distance to the train station increased. At shorter distances (e.g., 24 meters), the probability of selecting Walk was high, with approximately 92.7% likelihood and stays over 50% untill 1150 meters where it is dropping below. That means that every second individual is chosing a different transport mode than walking when the train station is away more then 1150 meters. On 1700 meters, just every fifth individual is choosing to go by walk. Starting from 2100 meters, the probability drops to less than 10%.</p>
<p>Overall, as the distance increased to 2500 meters and longer, the probability diminished to a small value, indicating a strong aversion to walking longer distances.</p>
<p>As the distance increases, the probability of choosing the “Bike” mode also increases. The probabilities start at 1.38% and gradually rise until they reache it’s maximum at 18.55%. This indicates that as the distance to the destination increases, there is a higher likelihood of choosing the “Bike” mode as the preferred transport mode.</p>
<p>Similar patterns were observed for Bus, Car, and Tram. The probabilities of choosing these modes increases as the distance increases. Each mode exhibited distinct probabilities at various distances, signifying the nuanced preferences of individuals.</p>
<p>These findings shed light on the relationship between distance and transport mode preferences. They highlight the decreased likelihood of selecting Walk as distances increase, while also emphasizing the varied preferences for Bike, Bus, Car, and Tram based on distance. Importantly, these probabilities are specific to the examined dataset and should be interpreted within the context of the broader study.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># weights:  15 (8 variable)
initial  value 329.934772 
iter  10 value 228.119051
final  value 226.022321 
converged</code></pre>
</div>
<div class="cell-output-display">
<div id="tbl-6" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;6: Summary of the regression model of transport mode and distance</caption>
<thead>
<tr class="header">
<th style="text-align: left;">y.level</th>
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bike</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-4.21238</td>
<td style="text-align: right;">0.19595</td>
<td style="text-align: right;">-21.49753</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bike</td>
<td style="text-align: left;">distance</td>
<td style="text-align: right;">0.00226</td>
<td style="text-align: right;">0.00020</td>
<td style="text-align: right;">11.24454</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bus</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-3.76963</td>
<td style="text-align: right;">0.26281</td>
<td style="text-align: right;">-14.34356</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bus</td>
<td style="text-align: left;">distance</td>
<td style="text-align: right;">0.00230</td>
<td style="text-align: right;">0.00021</td>
<td style="text-align: right;">11.04462</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Car</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-4.04416</td>
<td style="text-align: right;">0.27165</td>
<td style="text-align: right;">-14.88712</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Car</td>
<td style="text-align: left;">distance</td>
<td style="text-align: right;">0.00234</td>
<td style="text-align: right;">0.00021</td>
<td style="text-align: right;">11.34435</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tram</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-3.95006</td>
<td style="text-align: right;">0.13436</td>
<td style="text-align: right;">-29.39859</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tram</td>
<td style="text-align: left;">distance</td>
<td style="text-align: right;">0.00218</td>
<td style="text-align: right;">0.00020</td>
<td style="text-align: right;">10.85561</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result, <span class="fu">aes</span>(<span class="at">x =</span> total_time_value)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Walk, <span class="at">color =</span> <span class="st">"Walk"</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Bike, <span class="at">color =</span> <span class="st">"Bike"</span>)) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Bus, <span class="at">color =</span> <span class="st">"Bus"</span>)) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Car, <span class="at">color =</span> <span class="st">"Car"</span>)) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Tram, <span class="at">color =</span> <span class="st">"Tram"</span>)) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Walk"</span> <span class="ot">=</span> <span class="st">"black"</span>, <span class="st">"Bike"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Bus"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"Car"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Tram"</span> <span class="ot">=</span> <span class="st">"orange"</span>)) <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>), <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">color =</span> <span class="st">"gray"</span>,<span class="at">linewidth =</span> <span class="fl">1.1</span>)<span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Distance in meter"</span>, <span class="at">y =</span> <span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legends for the transport modes</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Transport Mode"</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-5-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5: Visualization of the regression model of transport mode and distance</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="direct-distance" class="level4">
<h4 class="anchored" data-anchor-id="direct-distance">Direct Distance</h4>
<p>The analysis of the distance already revealed substantial insights, the same analysis with the direct distance to the train station and the selection of the transport mode shows even stronger effects and sensitivities (<a href="#tbl-7">Table&nbsp;7</a> and <a href="#fig-6">Figure&nbsp;6</a>). All results are comparable, significant as the effects of distance.</p>
<p>As the direct distance to the train station increased, the probability of selecting Walk decreased more rapidly than with the original “distance” measure. For instance, at a direct distance of 650 meters, less than 50% of individuals were observed to choose walking as their mode of transport. The influence of direct distance became even more pronounced at greater distances. Around 950 meters, less than 20% or every fifth person opted to walk. This trend continued to the point where at approximately 1600 meters, only around 1% of individuals decided to walk.</p>
<p>Compared to the analysis with the overall trip distance, where a considerable proportion of individuals (about 10%) still preferred to walk at distances around 2100 meters, the “direct_distance” analysis reveals a much stronger aversion to walking longer distances. This indicates that the direct distance between the starting point and the train station may be a more accurate representation of individuals’ perceptions of distance and their consequent transport mode choices.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># weights:  15 (8 variable)
initial  value 329.934772 
iter  10 value 219.283360
final  value 211.767484 
converged</code></pre>
</div>
<div class="cell-output-display">
<div id="tbl-7" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;7: Summary of the regression model of transport mode and direct distance</caption>
<thead>
<tr class="header">
<th style="text-align: left;">y.level</th>
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bike</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-4.78602</td>
<td style="text-align: right;">0.31008</td>
<td style="text-align: right;">-15.43471</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bike</td>
<td style="text-align: left;">direct_distance</td>
<td style="text-align: right;">0.00466</td>
<td style="text-align: right;">0.00041</td>
<td style="text-align: right;">11.40403</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bus</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-4.12695</td>
<td style="text-align: right;">0.27001</td>
<td style="text-align: right;">-15.28429</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bus</td>
<td style="text-align: left;">direct_distance</td>
<td style="text-align: right;">0.00462</td>
<td style="text-align: right;">0.00042</td>
<td style="text-align: right;">11.01625</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Car</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-4.69759</td>
<td style="text-align: right;">0.27662</td>
<td style="text-align: right;">-16.98224</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Car</td>
<td style="text-align: left;">direct_distance</td>
<td style="text-align: right;">0.00480</td>
<td style="text-align: right;">0.00041</td>
<td style="text-align: right;">11.74964</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tram</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-4.36215</td>
<td style="text-align: right;">0.33205</td>
<td style="text-align: right;">-13.13721</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tram</td>
<td style="text-align: left;">direct_distance</td>
<td style="text-align: right;">0.00446</td>
<td style="text-align: right;">0.00043</td>
<td style="text-align: right;">10.46212</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result, <span class="fu">aes</span>(<span class="at">x =</span> total_time_value)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Walk, <span class="at">color =</span> <span class="st">"Walk"</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Bike, <span class="at">color =</span> <span class="st">"Bike"</span>)) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Bus, <span class="at">color =</span> <span class="st">"Bus"</span>)) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Car, <span class="at">color =</span> <span class="st">"Car"</span>)) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Tram, <span class="at">color =</span> <span class="st">"Tram"</span>)) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Walk"</span> <span class="ot">=</span> <span class="st">"black"</span>, <span class="st">"Bike"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Bus"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"Car"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Tram"</span> <span class="ot">=</span> <span class="st">"orange"</span>)) <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>), <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">color =</span> <span class="st">"gray"</span>,<span class="at">linewidth =</span> <span class="fl">1.1</span>)<span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Distance in meter"</span>, <span class="at">y =</span> <span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legends for the transport modes</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Transport Mode"</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-6-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6: Visualization of the regression model of transport mode and direct distance</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="time" class="level4">
<h4 class="anchored" data-anchor-id="time">Time</h4>
<p>The same analysis was conducted for the time measure. The resulting probabilities represent the likelihood of choosing a specific transport mode based on the total time values. The multinomial logistic regression model was fitted using the “total_time” variable as the predictor and the transport mode as the outcome variable, with the “Walk” mode as the reference level. The results of this regresssion are much harder to interpret and are less concrete as the ones before.</p>
<p>In this case, total time is a significant predictor for the Bike and Bus modes (p-values of 0.00201 and 0.02670, respectively), but not for the Car and Tram modes. This suggests that as total time increases, individuals are more likely to choose biking or taking the bus over walking, but total time does not significantly affect the choice between using the car or taking the tram over walking (<a href="#tbl-8">Table&nbsp;8</a>).</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># weights:  15 (8 variable)
initial  value 329.934772 
iter  10 value 293.554276
final  value 292.823378 
converged</code></pre>
</div>
<div class="cell-output-display">
<div id="tbl-8" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;8: Summary of the regression model of transport mode and time</caption>
<thead>
<tr class="header">
<th style="text-align: left;">y.level</th>
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bike</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-2.31855</td>
<td style="text-align: right;">0.40802</td>
<td style="text-align: right;">-5.68246</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bike</td>
<td style="text-align: left;">total_time</td>
<td style="text-align: right;">0.07342</td>
<td style="text-align: right;">0.02377</td>
<td style="text-align: right;">3.08849</td>
<td style="text-align: right;">0.00201</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bus</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-1.37823</td>
<td style="text-align: right;">0.32574</td>
<td style="text-align: right;">-4.23109</td>
<td style="text-align: right;">0.00002</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bus</td>
<td style="text-align: left;">total_time</td>
<td style="text-align: right;">0.04921</td>
<td style="text-align: right;">0.02221</td>
<td style="text-align: right;">2.21585</td>
<td style="text-align: right;">0.02670</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Car</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-1.15360</td>
<td style="text-align: right;">0.34593</td>
<td style="text-align: right;">-3.33477</td>
<td style="text-align: right;">0.00085</td>
</tr>
<tr class="even">
<td style="text-align: left;">Car</td>
<td style="text-align: left;">total_time</td>
<td style="text-align: right;">0.01675</td>
<td style="text-align: right;">0.02657</td>
<td style="text-align: right;">0.63020</td>
<td style="text-align: right;">0.52856</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tram</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-1.83401</td>
<td style="text-align: right;">0.39089</td>
<td style="text-align: right;">-4.69188</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tram</td>
<td style="text-align: left;">total_time</td>
<td style="text-align: right;">0.04377</td>
<td style="text-align: right;">0.02615</td>
<td style="text-align: right;">1.67367</td>
<td style="text-align: right;">0.09419</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Looking into the results, we can say that at a total time value of 10 minutes, the predicted probabilities suggest that individuals are most likely to choose walking with a probability of 45%, followed by using the “Bike” with 9.2%, taking the bus with 18.4%, taking the car with 16.7%, and using the Tram with 11.1% (<a href="#tbl-9">Table&nbsp;9</a>).</p>
<div id="tbl-9" class="anchored">
<table class="table">
<caption>Table&nbsp;9: Probabilities of choosing different transport modes based on total time values</caption>
<thead>
<tr class="header">
<th>Total Time (min)</th>
<th>Walk</th>
<th>Bike</th>
<th>Bus</th>
<th>Car</th>
<th>Tram</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>44.7%</td>
<td>9.2%</td>
<td>18.4%</td>
<td>16.7%</td>
<td>11.1%</td>
</tr>
<tr class="even">
<td>20</td>
<td>34.2%</td>
<td>14.6%</td>
<td>23.0%</td>
<td>15.1%</td>
<td>13.1%</td>
</tr>
<tr class="odd">
<td>30</td>
<td>24.3%</td>
<td>21.7%</td>
<td>26.8%</td>
<td>12.7%</td>
<td>14.5%</td>
</tr>
<tr class="even">
<td>40</td>
<td>16.1%</td>
<td>29.9%</td>
<td>29.1%</td>
<td>9.9%</td>
<td>14.8%</td>
</tr>
<tr class="odd">
<td>50</td>
<td>10.0%</td>
<td>38.8%</td>
<td>29.6%</td>
<td>7.3%</td>
<td>14.3%</td>
</tr>
<tr class="even">
<td>60</td>
<td>5.9%</td>
<td>47.5%</td>
<td>28.5%</td>
<td>5.1%</td>
<td>13.0%</td>
</tr>
</tbody>
</table>
</div>
<p>As the total time value increases, the predicted probabilities for going by walk decreases strongly (<a href="#fig-7">Figure&nbsp;7</a>).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result, <span class="fu">aes</span>(<span class="at">x =</span> total_time_value)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Walk, <span class="at">color =</span> <span class="st">"Walk"</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Bike, <span class="at">color =</span> <span class="st">"Bike"</span>)) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Bus, <span class="at">color =</span> <span class="st">"Bus"</span>)) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Car, <span class="at">color =</span> <span class="st">"Car"</span>)) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Tram, <span class="at">color =</span> <span class="st">"Tram"</span>)) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Walk"</span> <span class="ot">=</span> <span class="st">"black"</span>, <span class="st">"Bike"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Bus"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"Car"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Tram"</span> <span class="ot">=</span> <span class="st">"orange"</span>)) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>), <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">color =</span> <span class="st">"gray"</span>,<span class="at">linewidth =</span> <span class="fl">1.1</span>)<span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time in minutes"</span>, <span class="at">y =</span> <span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legends for the transport modes</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Transport Mode"</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-7-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;7: Visualization of the regression model of transport mode and time</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<p>Our study provides important insights into the influence of distance on transport mode preferences and the effectiveness of statistical methods in analyzing this relationship.</p>
<p>Firstly, we found that the distance to the nearest train station strongly affects individuals’ choices of transport mode. As the distance increases, the likelihood of selecting walking decreases, while the preference for alternative modes such as biking, taking the bus, driving a car, or using the tram increases.</p>
<p>Secondly, our statistical analysis demonstrated the effectiveness of tests and regression analysis in examining the relationship between distance and transport mode choice. These methods allowed us to quantify the impact of distance on mode preferences and provided valuable insights into the preferences of individuals.</p>
<p>Lastly, we investigated the influence of different distance measurement methods. Comparing the overall trip distance and the direct distance to the train station, we observed that the direct distance measurement revealed a stronger aversion to walking longer distances. Additionally, including total time alongside distance further influenced mode choice, with longer times favoring biking or taking the bus over walking.</p>
<p>In conclusion, our study highlights the importance of distance in shaping transport mode preferences, validates the effectiveness of statistical methods in analyzing this relationship, and emphasizes the impact of distance measurement methods and time considerations on mode choice.</p>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-europeanenvironmentagencyeea2019" class="csl-entry" role="doc-biblioentry">
European Environment Agency (EEA). 2019. <em>The First and Last Mile — the Key to Sustainable Urban Transport. <span>Transport</span> and Environment Report 2019</em>. <span>Publications Office of the European Union</span>. <a href="https://data.europa.eu/doi/10.2800/200903">https://data.europa.eu/doi/10.2800/200903</a>.
</div>
<div id="ref-games1976" class="csl-entry" role="doc-biblioentry">
Games, Paul A., and John F. Howell. 1976. <span>“Pairwise <span>Multiple Comparison Procedures</span> with <span>Unequal N</span>’s and/or <span>Variances</span>: <span>A Monte Carlo Study</span>.”</span> <em>Journal of Educational Statistics</em> 1 (2): 113–25. <a href="https://doi.org/10.3102/10769986001002113">https://doi.org/10.3102/10769986001002113</a>.
</div>
<div id="ref-genossenschaftposmoschweiz2022" class="csl-entry" role="doc-biblioentry">
Genossenschaft Posmo Schweiz. 2022. <span>“Posmo <span>Project App</span> – <span>Tracking</span> Für <span>Gruppen</span>.”</span> <a href="https://posmo.coop/produkte/posmo-project-tracking-fuer-gruppen">https://posmo.coop/produkte/posmo-project-tracking-fuer-gruppen</a>.
</div>
<div id="ref-levene1960" class="csl-entry" role="doc-biblioentry">
Levene, H. 1960. <span>“Robust Tests for Equality of Variances.”</span> <em>Contributions to Probability and Statistics: Essays in Honor of Harold Hotelling</em> 2: 278–92.
</div>
<div id="ref-shapiro1965" class="csl-entry" role="doc-biblioentry">
Shapiro, S. S., and M. B. Wilk. 1965. <span>“An <span>Analysis</span> of <span>Variance Test</span> for <span>Normality</span> (<span>Complete Samples</span>).”</span> <em>Biometrika</em> 52 (3/4): 591. <a href="https://doi.org/10.2307/2333709">https://doi.org/10.2307/2333709</a>.
</div>
<div id="ref-tennoy2022" class="csl-entry" role="doc-biblioentry">
Tennøy, Aud, Marianne Knapskog, and Fitwi Wolday. 2022. <span>“Walking Distances to Public Transport in Smaller and Larger <span>Norwegian</span> Cities.”</span> <em>Transportation Research Part D: Transport and Environment</em> 103 (February): 103169. <a href="https://doi.org/10.1016/j.trd.2022.103169">https://doi.org/10.1016/j.trd.2022.103169</a>.
</div>
<div id="ref-welch1951" class="csl-entry" role="doc-biblioentry">
Welch, B. L. 1951. <span>“On the <span>Comparison</span> of <span>Several Mean Values</span>: <span>An Alternative Approach</span>.”</span> <em>Biometrika</em> 38 (3/4): 330. <a href="https://doi.org/10.2307/2332579">https://doi.org/10.2307/2332579</a>.
</div>
<div id="ref-wibowo2010" class="csl-entry" role="doc-biblioentry">
Wibowo, Sony Sulaksono, and Saksith Chalermpong. 2010. <span>“Characteristics of <span>Mode Choice</span> Within <span>Mass Transit Catchments Area</span>.”</span> <span>Eastern Asia Society for Transportation Studies</span>. <a href="https://doi.org/10.11175/easts.8.1261">https://doi.org/10.11175/easts.8.1261</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>